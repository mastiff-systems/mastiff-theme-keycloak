{"version":3,"file":"Applications-Dh2fkIw8.js","sources":["../../../../../../../../../node_modules/.pnpm/@patternfly+react-core@5.4.14_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@patternfly/react-core/dist/esm/components/DataList/DataListToggle.js","../../../../../../../src/applications/Applications.tsx"],"sourcesContent":["import { __rest } from \"tslib\";\nimport * as React from 'react';\nimport { css } from '@patternfly/react-styles';\nimport AngleRightIcon from '@patternfly/react-icons/dist/esm/icons/angle-right-icon';\nimport styles from '@patternfly/react-styles/css/components/DataList/data-list.mjs';\nimport { Button, ButtonVariant } from '../Button';\nexport const DataListToggle = (_a) => {\n    var { className = '', isExpanded = false, 'aria-controls': ariaControls = '', 'aria-label': ariaLabel = 'Details', rowid = '', id, buttonProps } = _a, props = __rest(_a, [\"className\", \"isExpanded\", 'aria-controls', 'aria-label', \"rowid\", \"id\", \"buttonProps\"]);\n    return (React.createElement(\"div\", Object.assign({ className: css(styles.dataListItemControl, className) }, props),\n        React.createElement(\"div\", { className: css(styles.dataListToggle) },\n            React.createElement(Button, Object.assign({ id: id, variant: ButtonVariant.plain, \"aria-controls\": ariaControls !== '' && ariaControls, \"aria-label\": ariaLabel, \"aria-labelledby\": ariaLabel !== 'Details' ? null : `${rowid} ${id}`, \"aria-expanded\": isExpanded }, buttonProps),\n                React.createElement(\"div\", { className: css(styles.dataListToggleIcon) },\n                    React.createElement(AngleRightIcon, null))))));\n};\nDataListToggle.displayName = 'DataListToggle';\n//# sourceMappingURL=DataListToggle.js.map","import {\n  ContinueCancelModal,\n  label,\n  useEnvironment,\n} from \"@keycloak/keycloak-ui-shared\";\nimport {\n  Button,\n  DataList,\n  DataListCell,\n  DataListContent,\n  DataListItem,\n  DataListItemCells,\n  DataListItemRow,\n  DataListToggle,\n  DescriptionList,\n  DescriptionListDescription,\n  DescriptionListGroup,\n  DescriptionListTerm,\n  Grid,\n  GridItem,\n  Spinner,\n} from \"@patternfly/react-core\";\nimport {\n  CheckIcon,\n  ExternalLinkAltIcon,\n  InfoAltIcon,\n} from \"@patternfly/react-icons\";\nimport { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { deleteConsent, getApplications } from \"../api/methods\";\nimport { ClientRepresentation } from \"../api/representations\";\nimport { Page } from \"../components/page/Page\";\nimport { TFuncKey } from \"../i18n\";\nimport { formatDate } from \"../utils/formatDate\";\nimport { useAccountAlerts } from \"../utils/useAccountAlerts\";\nimport { usePromise } from \"../utils/usePromise\";\n\ntype Application = ClientRepresentation & {\n  open: boolean;\n};\n\nexport const Applications = () => {\n  const { t } = useTranslation();\n  const context = useEnvironment();\n  const { addAlert, addError } = useAccountAlerts();\n\n  const [applications, setApplications] = useState<Application[]>();\n  const [key, setKey] = useState(1);\n  const refresh = () => setKey(key + 1);\n\n  usePromise(\n    (signal) => getApplications({ signal, context }),\n    (clients) => setApplications(clients.map((c) => ({ ...c, open: false }))),\n    [key],\n  );\n\n  const toggleOpen = (clientId: string) => {\n    setApplications([\n      ...applications!.map((a) =>\n        a.clientId === clientId ? { ...a, open: !a.open } : a,\n      ),\n    ]);\n  };\n\n  const removeConsent = async (id: string) => {\n    try {\n      await deleteConsent(context, id);\n      refresh();\n      addAlert(t(\"removeConsentSuccess\"));\n    } catch (error) {\n      addError(\"removeConsentError\", error);\n    }\n  };\n\n  if (!applications) {\n    return <Spinner />;\n  }\n\n  return (\n    <Page title={t(\"application\")} description={t(\"applicationsIntroMessage\")}>\n      <DataList id=\"applications-list\" aria-label={t(\"application\")}>\n        <DataListItem\n          id=\"applications-list-header\"\n          aria-labelledby=\"Columns names\"\n        >\n          <DataListItemRow>\n            <span style={{ visibility: \"hidden\", height: 55 }}>\n              <DataListToggle\n                id=\"applications-list-header-invisible-toggle\"\n                aria-controls=\"applications-list-content\"\n              />\n            </span>\n            <DataListItemCells\n              dataListCells={[\n                <DataListCell\n                  key=\"applications-list-client-id-header\"\n                  width={2}\n                  className=\"pf-v5-u-pt-md\"\n                >\n                  <strong>{t(\"name\")}</strong>\n                </DataListCell>,\n                <DataListCell\n                  key=\"applications-list-app-type-header\"\n                  width={2}\n                  className=\"pf-v5-u-pt-md\"\n                >\n                  <strong>{t(\"applicationType\")}</strong>\n                </DataListCell>,\n                <DataListCell\n                  key=\"applications-list-status\"\n                  width={2}\n                  className=\"pf-v5-u-pt-md\"\n                >\n                  <strong>{t(\"status\")}</strong>\n                </DataListCell>,\n              ]}\n            />\n          </DataListItemRow>\n        </DataListItem>\n        {applications.map((application) => (\n          <DataListItem\n            key={application.clientId}\n            aria-labelledby=\"applications-list\"\n            data-testid=\"applications-list-item\"\n            isExpanded={application.open}\n          >\n            <DataListItemRow className=\"pf-v5-u-align-items-center\">\n              <DataListToggle\n                onClick={() => toggleOpen(application.clientId)}\n                isExpanded={application.open}\n                id={`toggle-${application.clientId}`}\n                aria-controls={`content-${application.clientId}`}\n              />\n              <DataListItemCells\n                className=\"pf-v5-u-align-items-center\"\n                dataListCells={[\n                  <DataListCell width={2} key={`client${application.clientId}`}>\n                    {application.effectiveUrl && (\n                      <Button\n                        className=\"pf-v5-u-pl-0 title-case\"\n                        component=\"a\"\n                        variant=\"link\"\n                        onClick={() => window.open(application.effectiveUrl)}\n                      >\n                        {label(\n                          t,\n                          application.clientName || application.clientId,\n                        )}{\" \"}\n                        <ExternalLinkAltIcon />\n                      </Button>\n                    )}\n                    {!application.effectiveUrl && (\n                      <>\n                        {label(\n                          t,\n                          application.clientName || application.clientId,\n                        )}\n                      </>\n                    )}\n                  </DataListCell>,\n                  <DataListCell\n                    width={2}\n                    key={`internal${application.clientId}`}\n                  >\n                    {application.userConsentRequired\n                      ? t(\"thirdPartyApp\")\n                      : t(\"internalApp\")}\n                    {application.offlineAccess ? \", \" + t(\"offlineAccess\") : \"\"}\n                  </DataListCell>,\n                  <DataListCell width={2} key={`status${application.clientId}`}>\n                    {application.inUse ? t(\"inUse\") : t(\"notInUse\")}\n                  </DataListCell>,\n                ]}\n              />\n            </DataListItemRow>\n\n            <DataListContent\n              id={`content-${application.clientId}`}\n              className=\"pf-v5-u-pl-4xl\"\n              aria-label={t(\"applicationDetails\", {\n                clientId: application.clientId,\n              })}\n              isHidden={!application.open}\n            >\n              <DescriptionList>\n                <DescriptionListGroup>\n                  <DescriptionListTerm>{t(\"client\")}</DescriptionListTerm>\n                  <DescriptionListDescription>\n                    {application.clientId}\n                  </DescriptionListDescription>\n                </DescriptionListGroup>\n                {application.description && (\n                  <DescriptionListGroup>\n                    <DescriptionListTerm>\n                      {t(\"description\")}\n                    </DescriptionListTerm>\n                    <DescriptionListDescription>\n                      {application.description}\n                    </DescriptionListDescription>\n                  </DescriptionListGroup>\n                )}\n                {application.effectiveUrl && (\n                  <DescriptionListGroup>\n                    <DescriptionListTerm>URL</DescriptionListTerm>\n                    <DescriptionListDescription>\n                      {application.effectiveUrl.split('\"')}\n                    </DescriptionListDescription>\n                  </DescriptionListGroup>\n                )}\n                {application.consent && (\n                  <>\n                    <DescriptionListGroup>\n                      <DescriptionListTerm>\n                        {t(\"hasAccessTo\")}\n                      </DescriptionListTerm>\n                      {application.consent.grantedScopes.map((scope) => (\n                        <DescriptionListDescription key={`scope${scope.id}`}>\n                          <CheckIcon />{\" \"}\n                          {t(scope.name as TFuncKey, scope.displayText)}\n                        </DescriptionListDescription>\n                      ))}\n                    </DescriptionListGroup>\n                    {application.tosUri && (\n                      <DescriptionListGroup>\n                        <DescriptionListTerm>\n                          {t(\"termsOfService\")}\n                        </DescriptionListTerm>\n                        <DescriptionListDescription>\n                          {application.tosUri}\n                        </DescriptionListDescription>\n                      </DescriptionListGroup>\n                    )}\n                    {application.policyUri && (\n                      <DescriptionListGroup>\n                        <DescriptionListTerm>\n                          {t(\"privacyPolicy\")}\n                        </DescriptionListTerm>\n                        <DescriptionListDescription>\n                          {application.policyUri}\n                        </DescriptionListDescription>\n                      </DescriptionListGroup>\n                    )}\n                    {application.logoUri && (\n                      <DescriptionListGroup>\n                        <DescriptionListTerm>{t(\"logo\")}</DescriptionListTerm>\n                        <DescriptionListDescription>\n                          <img src={application.logoUri} />\n                        </DescriptionListDescription>\n                      </DescriptionListGroup>\n                    )}\n                    <DescriptionListGroup>\n                      <DescriptionListTerm>\n                        {t(\"accessGrantedOn\")}\n                      </DescriptionListTerm>\n                      <DescriptionListDescription>\n                        {formatDate(new Date(application.consent.createdDate))}\n                      </DescriptionListDescription>\n                    </DescriptionListGroup>\n                  </>\n                )}\n              </DescriptionList>\n              {(application.consent || application.offlineAccess) && (\n                <Grid hasGutter>\n                  <hr />\n                  <GridItem>\n                    <ContinueCancelModal\n                      buttonTitle={t(\"removeAccess\")}\n                      modalTitle={t(\"removeAccess\")}\n                      continueLabel={t(\"confirm\")}\n                      cancelLabel={t(\"cancel\")}\n                      buttonVariant=\"secondary\"\n                      onContinue={() => removeConsent(application.clientId)}\n                    >\n                      {t(\"removeModalMessage\", { name: application.clientId })}\n                    </ContinueCancelModal>\n                  </GridItem>\n                  <GridItem>\n                    <InfoAltIcon /> {t(\"infoMessage\")}\n                  </GridItem>\n                </Grid>\n              )}\n            </DataListContent>\n          </DataListItem>\n        ))}\n      </DataList>\n    </Page>\n  );\n};\n\nexport default Applications;\n"],"names":["DataListToggle","_a","className","isExpanded","ariaControls","ariaLabel","rowid","id","buttonProps","props","__rest","React","css","styles","Button","ButtonVariant","AngleRightIcon","Applications","useTranslation","context","useEnvironment","addAlert","addError","useAccountAlerts","applications","setApplications","useState","key","setKey","refresh","usePromise","signal","getApplications","clients","c","toggleOpen","clientId","a","removeConsent","deleteConsent","error","Page","DataList","jsx","DataListItem","DataListItemRow","DataListItemCells","DataListCell","application","jsxs","label","ExternalLinkAltIcon","Fragment","DataListContent","DescriptionList","DescriptionListGroup","DescriptionListTerm","DescriptionListDescription","scope","CheckIcon","formatDate","Grid","GridItem","ContinueCancelModal","InfoAltIcon","Spinner"],"mappings":"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","x_google_ignoreList":[0]}