{"version":3,"file":"SigningIn-Bg7EoUzs.js","sources":["../../../../../../../src/account-security/SigningIn.tsx"],"sourcesContent":["import {\n  Button,\n  DataList,\n  DataListAction,\n  DataListCell,\n  DataListItem,\n  DataListItemCells,\n  DataListItemRow,\n  DescriptionList,\n  DescriptionListDescription,\n  DescriptionListGroup,\n  DescriptionListTerm,\n  Dropdown,\n  DropdownItem,\n  MenuToggle,\n  PageSection,\n  Spinner,\n  Split,\n  SplitItem,\n  Title,\n} from \"@patternfly/react-core\";\nimport {\n  EllipsisVIcon,\n  ExclamationTriangleIcon,\n  InfoAltIcon,\n} from \"@patternfly/react-icons\";\nimport { CSSProperties, Fragment, useState } from \"react\";\nimport { Trans, useTranslation } from \"react-i18next\";\nimport { useEnvironment } from \"@keycloak/keycloak-ui-shared\";\nimport { getCredentials } from \"../api/methods\";\nimport {\n  CredentialContainer,\n  CredentialMetadataRepresentation,\n} from \"../api/representations\";\nimport { EmptyRow } from \"../components/datalist/EmptyRow\";\nimport { Page } from \"../components/page/Page\";\nimport { TFuncKey } from \"../i18n\";\nimport { formatDate } from \"../utils/formatDate\";\nimport { usePromise } from \"../utils/usePromise\";\n\ntype MobileLinkProps = {\n  title: string;\n  onClick: () => void;\n  testid?: string;\n};\n\nconst MobileLink = ({ title, onClick, testid }: MobileLinkProps) => {\n  const [open, setOpen] = useState(false);\n  return (\n    <>\n      <Dropdown\n        popperProps={{\n          position: \"right\",\n        }}\n        onOpenChange={(isOpen) => setOpen(isOpen)}\n        toggle={(toggleRef) => (\n          <MenuToggle\n            className=\"pf-v5-u-display-none-on-lg\"\n            ref={toggleRef}\n            variant=\"plain\"\n            onClick={() => setOpen(!open)}\n            isExpanded={open}\n          >\n            <EllipsisVIcon />\n          </MenuToggle>\n        )}\n        isOpen={open}\n      >\n        <DropdownItem key=\"1\" onClick={onClick}>\n          {title}\n        </DropdownItem>\n      </Dropdown>\n      <Button\n        variant=\"link\"\n        onClick={onClick}\n        className=\"pf-v5-u-display-none pf-v5-u-display-inline-flex-on-lg\"\n        data-testid={testid}\n      >\n        {title}\n      </Button>\n    </>\n  );\n};\n\nexport const SigningIn = () => {\n  const { t } = useTranslation();\n  const context = useEnvironment();\n  const { login } = context.keycloak;\n\n  const [credentials, setCredentials] = useState<CredentialContainer[]>();\n\n  usePromise(\n    (signal) => getCredentials({ signal, context }),\n    setCredentials,\n    [],\n  );\n\n  const credentialRowCells = (\n    credMetadata: CredentialMetadataRepresentation,\n  ) => {\n    const credential = credMetadata.credential;\n    const maxWidth = {\n      \"--pf-v5-u-max-width--MaxWidth\": \"300px\",\n    } as CSSProperties;\n    const items = [\n      <DataListCell\n        key=\"title\"\n        data-testrole=\"label\"\n        className=\"pf-v5-u-max-width\"\n        style={maxWidth}\n      >\n        {t(credential.userLabel) || t(credential.type as TFuncKey)}\n      </DataListCell>,\n    ];\n\n    if (credential.createdDate) {\n      items.push(\n        <DataListCell\n          key={\"created\" + credential.id}\n          data-testrole=\"created-at\"\n        >\n          <Trans i18nKey=\"credentialCreatedAt\">\n            <strong className=\"pf-v5-u-mr-md\"></strong>\n            {{ date: formatDate(new Date(credential.createdDate)) }}\n          </Trans>\n        </DataListCell>,\n      );\n    }\n    if (\n      credMetadata.infoMessage ||\n      credMetadata.infoProperties ||\n      (credMetadata.warningMessageTitle &&\n        credMetadata.warningMessageDescription)\n    ) {\n      items.push(\n        <DataListCell\n          key={\"warning-message\" + credential.id}\n          data-testrole=\"warning-message\"\n        >\n          <>\n            {credMetadata.infoMessage && (\n              <p>\n                <InfoAltIcon />{\" \"}\n                {t(\n                  credMetadata.infoMessage.key,\n                  credMetadata.infoMessage.parameters?.reduce(\n                    (acc, val, idx) => ({ ...acc, [idx]: val }),\n                    {},\n                  ),\n                )}\n              </p>\n            )}\n            {credMetadata.infoProperties && (\n              <Split className=\"pf-v5-u-mb-lg\">\n                <SplitItem>\n                  <InfoAltIcon />\n                </SplitItem>\n                <SplitItem isFilled className=\"pf-v5-u-ml-xs\">\n                  <DescriptionList\n                    isHorizontal\n                    horizontalTermWidthModifier={{\n                      \"2xl\": \"15ch\",\n                    }}\n                  >\n                    {credMetadata.infoProperties.map((prop) => (\n                      <DescriptionListGroup key={prop.key}>\n                        <DescriptionListTerm>{t(prop.key)}</DescriptionListTerm>\n                        <DescriptionListDescription>\n                          {prop.parameters ? prop.parameters[0] : \"\"}\n                        </DescriptionListDescription>\n                      </DescriptionListGroup>\n                    ))}\n                  </DescriptionList>\n                </SplitItem>\n              </Split>\n            )}\n            {credMetadata.warningMessageTitle &&\n              credMetadata.warningMessageDescription && (\n                <>\n                  <p>\n                    <ExclamationTriangleIcon />{\" \"}\n                    {t(\n                      credMetadata.warningMessageTitle.key,\n                      credMetadata.warningMessageTitle.parameters?.reduce(\n                        (acc, val, idx) => ({ ...acc, [idx]: val }),\n                        {},\n                      ),\n                    )}\n                  </p>\n                  <p>\n                    {t(\n                      credMetadata.warningMessageDescription.key,\n                      credMetadata.warningMessageDescription.parameters?.reduce(\n                        (acc, val, idx) => ({ ...acc, [idx]: val }),\n                        {},\n                      ),\n                    )}\n                  </p>\n                </>\n              )}\n          </>\n        </DataListCell>,\n      );\n    }\n    return items;\n  };\n\n  if (!credentials) {\n    return <Spinner />;\n  }\n\n  const credentialUniqueCategories = [\n    ...new Set(credentials.map((c) => c.category)),\n  ];\n\n  return (\n    <Page title={t(\"signingIn\")} description={t(\"signingInDescription\")}>\n      {credentialUniqueCategories.map((category) => (\n        <PageSection key={category} variant=\"light\" className=\"pf-v5-u-px-0\">\n          <Title headingLevel=\"h2\" size=\"xl\" id={`${category}-categ-title`}>\n            {t(category as TFuncKey)}\n          </Title>\n          {credentials\n            .filter((cred) => cred.category == category)\n            .map((container) => (\n              <Fragment key={container.type}>\n                <Split className=\"pf-v5-u-mt-lg pf-v5-u-mb-lg\">\n                  <SplitItem>\n                    <Title\n                      headingLevel=\"h3\"\n                      size=\"md\"\n                      className=\"pf-v5-u-mb-md\"\n                      data-testid={`${container.type}/help`}\n                    >\n                      <span\n                        className=\"cred-title pf-v5-u-display-block\"\n                        data-testid={`${container.type}/title`}\n                      >\n                        {t(container.displayName as TFuncKey)}\n                      </span>\n                    </Title>\n                    <span data-testid={`${container.type}/help-text`}>\n                      {t(container.helptext as TFuncKey)}\n                    </span>\n                  </SplitItem>\n                  {container.createAction && (\n                    <SplitItem isFilled>\n                      <div className=\"pf-v5-u-float-right\">\n                        <MobileLink\n                          onClick={() =>\n                            login({\n                              action: container.createAction,\n                            })\n                          }\n                          title={t(\"setUpNew\", {\n                            name: t(\n                              `${container.type}-display-name` as TFuncKey,\n                            ),\n                          })}\n                          testid={`${container.type}/create`}\n                        />\n                      </div>\n                    </SplitItem>\n                  )}\n                </Split>\n\n                <DataList\n                  aria-label=\"credential list\"\n                  className=\"pf-v5-u-mb-xl\"\n                  data-testid={`${container.type}/credential-list`}\n                >\n                  {container.userCredentialMetadatas.length === 0 && (\n                    <EmptyRow\n                      message={t(\"notSetUp\", {\n                        name: t(container.displayName as TFuncKey),\n                      })}\n                      data-testid={`${container.type}/not-set-up`}\n                    />\n                  )}\n\n                  {container.userCredentialMetadatas.map((meta) => (\n                    <DataListItem key={meta.credential.id}>\n                      <DataListItemRow id={`cred-${meta.credential.id}`}>\n                        <DataListItemCells\n                          className=\"pf-v5-u-py-0\"\n                          dataListCells={[\n                            ...credentialRowCells(meta),\n                            <DataListAction\n                              key=\"action\"\n                              id={`action-${meta.credential.id}`}\n                              aria-label={t(\"updateCredAriaLabel\")}\n                              aria-labelledby={`cred-${meta.credential.id}`}\n                            >\n                              {container.removeable && (\n                                <Button\n                                  variant=\"danger\"\n                                  data-testrole=\"remove\"\n                                  onClick={async () => {\n                                    await login({\n                                      action:\n                                        \"delete_credential:\" +\n                                        meta.credential.id,\n                                    });\n                                  }}\n                                >\n                                  {t(\"delete\")}\n                                </Button>\n                              )}\n                              {container.updateAction && (\n                                <Button\n                                  variant=\"secondary\"\n                                  onClick={async () => {\n                                    await login({\n                                      action: container.updateAction,\n                                    });\n                                  }}\n                                  data-testrole=\"update\"\n                                >\n                                  {t(\"update\")}\n                                </Button>\n                              )}\n                            </DataListAction>,\n                          ]}\n                        />\n                      </DataListItemRow>\n                    </DataListItem>\n                  ))}\n                </DataList>\n              </Fragment>\n            ))}\n        </PageSection>\n      ))}\n    </Page>\n  );\n};\n\nexport default SigningIn;\n"],"names":["MobileLink","title","onClick","testid","open","setOpen","useState","jsxs","Fragment","jsx","Dropdown","isOpen","toggleRef","MenuToggle","EllipsisVIcon","DropdownItem","Button","SigningIn","t","useTranslation","context","useEnvironment","login","credentials","setCredentials","usePromise","signal","getCredentials","credentialRowCells","credMetadata","credential","items","DataListCell","Trans","formatDate","InfoAltIcon","acc","val","idx","Split","SplitItem","DescriptionList","prop","DescriptionListGroup","DescriptionListTerm","DescriptionListDescription","ExclamationTriangleIcon","Spinner","credentialUniqueCategories","c","Page","category","PageSection","Title","cred","container","DataList","EmptyRow","meta","DataListItem","DataListItemRow","DataListItemCells","DataListAction"],"mappings":"ooBA8CA,MAAMA,EAAa,CAAC,CAAE,MAAAC,EAAO,QAAAC,EAAS,OAAAC,KAA8B,CAClE,KAAM,CAACC,EAAMC,CAAO,EAAIC,EAAS,EAAK,EACtC,OACEC,EAAAC,EAAA,CACE,SAAA,CAAAC,EAACC,EAAA,CACC,YAAa,CACX,SAAU,OAAA,EAEZ,aAAeC,GAAWN,EAAQM,CAAM,EACxC,OAASC,GACPH,EAACI,EAAA,CACC,UAAU,6BACV,IAAKD,EACL,QAAQ,QACR,QAAS,IAAMP,EAAQ,CAACD,CAAI,EAC5B,WAAYA,EAEZ,WAACU,EAAA,CAAA,CAAc,CAAA,CAAA,EAGnB,OAAQV,EAER,SAAAK,EAACM,EAAA,CAAqB,QAAAb,EACnB,SAAAD,CAAA,EADe,GAElB,CAAA,CAAA,EAEFQ,EAACO,EAAA,CACC,QAAQ,OACR,QAAAd,EACA,UAAU,yDACV,cAAaC,EAEZ,SAAAF,CAAA,CAAA,CACH,EACF,CAEJ,EAEagB,GAAY,IAAM,CAC7B,KAAM,CAAE,EAAAC,CAAA,EAAMC,EAAA,EACRC,EAAUC,EAAA,EACV,CAAE,MAAAC,GAAUF,EAAQ,SAEpB,CAACG,EAAaC,CAAc,EAAIlB,EAAA,EAEtCmB,EACGC,GAAWC,EAAe,CAAE,OAAAD,EAAQ,QAAAN,EAAS,EAC9CI,EACA,CAAA,CAAC,EAGH,MAAMI,EACJC,GACG,CACH,MAAMC,EAAaD,EAAa,WAI1BE,EAAQ,CACZtB,EAACuB,EAAA,CAEC,gBAAc,QACd,UAAU,oBACV,MARa,CACf,gCAAiC,OAAA,EAS9B,WAAEF,EAAW,SAAS,GAAKZ,EAAEY,EAAW,IAAgB,CAAA,EALrD,OAAA,CAMN,EAGF,OAAIA,EAAW,aACbC,EAAM,KACJtB,EAACuB,EAAA,CAEC,gBAAc,aAEd,SAAAzB,EAAC0B,EAAA,CAAM,QAAQ,sBACb,SAAA,CAAAxB,EAAC,SAAA,CAAO,UAAU,eAAA,CAAgB,EACjC,CAAE,KAAMyB,EAAW,IAAI,KAAKJ,EAAW,WAAW,CAAC,CAAA,CAAE,CAAA,CACxD,CAAA,EANK,UAAYA,EAAW,EAAA,CAO9B,GAIFD,EAAa,aACbA,EAAa,gBACZA,EAAa,qBACZA,EAAa,4BAEfE,EAAM,KACJtB,EAACuB,EAAA,CAEC,gBAAc,kBAEd,SAAAzB,EAAAC,EAAA,CACG,SAAA,CAAAqB,EAAa,eACX,IAAA,CACC,SAAA,CAAApB,EAAC0B,EAAA,EAAY,EAAG,IACfjB,EACCW,EAAa,YAAY,IACzBA,EAAa,YAAY,YAAY,OACnC,CAACO,EAAKC,EAAKC,KAAS,CAAE,GAAGF,EAAK,CAACE,CAAG,EAAGD,IACrC,CAAA,CAAC,CACH,CACF,EACF,EAEDR,EAAa,gBACZtB,EAACgC,EAAA,CAAM,UAAU,gBACf,SAAA,CAAA9B,EAAC+B,EAAA,CACC,SAAA/B,EAAC0B,EAAA,CAAA,CAAY,EACf,EACA1B,EAAC+B,EAAA,CAAU,SAAQ,GAAC,UAAU,gBAC5B,SAAA/B,EAACgC,EAAA,CACC,aAAY,GACZ,4BAA6B,CAC3B,MAAO,MAAA,EAGR,WAAa,eAAe,IAAKC,KAC/BC,EAAA,CACC,SAAA,CAAAlC,EAACmC,EAAA,CAAqB,SAAA1B,EAAEwB,EAAK,GAAG,EAAE,EAClCjC,EAACoC,GACE,SAAAH,EAAK,WAAaA,EAAK,WAAW,CAAC,EAAI,EAAA,CAC1C,CAAA,CAAA,EAJyBA,EAAK,GAKhC,CACD,CAAA,CAAA,CACH,CACF,CAAA,EACF,EAEDb,EAAa,qBACZA,EAAa,2BACXtB,EAAAC,EAAA,CACE,SAAA,CAAAD,EAAC,IAAA,CACC,SAAA,CAAAE,EAACqC,EAAA,EAAwB,EAAG,IAC3B5B,EACCW,EAAa,oBAAoB,IACjCA,EAAa,oBAAoB,YAAY,OAC3C,CAACO,EAAKC,EAAKC,KAAS,CAAE,GAAGF,EAAK,CAACE,CAAG,EAAGD,IACrC,CAAA,CAAC,CACH,CACF,EACF,IACC,IAAA,CACE,SAAAnB,EACCW,EAAa,0BAA0B,IACvCA,EAAa,0BAA0B,YAAY,OACjD,CAACO,EAAKC,EAAKC,KAAS,CAAE,GAAGF,EAAK,CAACE,CAAG,EAAGD,IACrC,CAAA,CAAC,CACH,CACF,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAEN,CAAA,EAhEK,kBAAoBP,EAAW,EAAA,CAiEtC,EAGGC,CACT,EAEA,GAAI,CAACR,EACH,SAAQwB,EAAA,EAAQ,EAGlB,MAAMC,EAA6B,CACjC,GAAG,IAAI,IAAIzB,EAAY,IAAK0B,GAAMA,EAAE,QAAQ,CAAC,CAAA,EAG/C,SACGC,EAAA,CAAK,MAAOhC,EAAE,WAAW,EAAG,YAAaA,EAAE,sBAAsB,EAC/D,SAAA8B,EAA2B,IAAKG,GAC/B5C,EAAC6C,GAA2B,QAAQ,QAAQ,UAAU,eACpD,SAAA,CAAA3C,EAAC4C,EAAA,CAAM,aAAa,KAAK,KAAK,KAAK,GAAI,GAAGF,CAAQ,eAC/C,SAAAjC,EAAEiC,CAAoB,EACzB,EACC5B,EACE,OAAQ+B,GAASA,EAAK,UAAYH,CAAQ,EAC1C,IAAKI,GACJhD,EAACC,EAAA,CACC,SAAA,CAAAD,EAACgC,EAAA,CAAM,UAAU,8BACf,SAAA,CAAAhC,EAACiC,EAAA,CACC,SAAA,CAAA/B,EAAC4C,EAAA,CACC,aAAa,KACb,KAAK,KACL,UAAU,gBACV,cAAa,GAAGE,EAAU,IAAI,QAE9B,SAAA9C,EAAC,OAAA,CACC,UAAU,mCACV,cAAa,GAAG8C,EAAU,IAAI,SAE7B,SAAArC,EAAEqC,EAAU,WAAuB,CAAA,CAAA,CACtC,CAAA,EAEF9C,EAAC,OAAA,CAAK,cAAa,GAAG8C,EAAU,IAAI,aACjC,SAAArC,EAAEqC,EAAU,QAAoB,CAAA,CACnC,CAAA,EACF,EACCA,EAAU,cACT9C,EAAC+B,EAAA,CAAU,SAAQ,GACjB,SAAA/B,EAAC,MAAA,CAAI,UAAU,sBACb,SAAAA,EAACT,EAAA,CACC,QAAS,IACPsB,EAAM,CACJ,OAAQiC,EAAU,YAAA,CACnB,EAEH,MAAOrC,EAAE,WAAY,CACnB,KAAMA,EACJ,GAAGqC,EAAU,IAAI,eAAA,CACnB,CACD,EACD,OAAQ,GAAGA,EAAU,IAAI,SAAA,CAAA,EAE7B,CAAA,CACF,CAAA,EAEJ,EAEAhD,EAACiD,EAAA,CACC,aAAW,kBACX,UAAU,gBACV,cAAa,GAAGD,EAAU,IAAI,mBAE7B,SAAA,CAAAA,EAAU,wBAAwB,SAAW,GAC5C9C,EAACgD,EAAA,CACC,QAASvC,EAAE,WAAY,CACrB,KAAMA,EAAEqC,EAAU,WAAuB,CAAA,CAC1C,EACD,cAAa,GAAGA,EAAU,IAAI,aAAA,CAAA,EAIjCA,EAAU,wBAAwB,IAAKG,GACtCjD,EAACkD,EAAA,CACC,SAAAlD,EAACmD,EAAA,CAAgB,GAAI,QAAQF,EAAK,WAAW,EAAE,GAC7C,SAAAjD,EAACoD,EAAA,CACC,UAAU,eACV,cAAe,CACb,GAAGjC,EAAmB8B,CAAI,EAC1BnD,EAACuD,EAAA,CAEC,GAAI,UAAUJ,EAAK,WAAW,EAAE,GAChC,aAAYxC,EAAE,qBAAqB,EACnC,kBAAiB,QAAQwC,EAAK,WAAW,EAAE,GAE1C,SAAA,CAAAH,EAAU,YACT9C,EAACO,EAAA,CACC,QAAQ,SACR,gBAAc,SACd,QAAS,SAAY,CACnB,MAAMM,EAAM,CACV,OACE,qBACAoC,EAAK,WAAW,EAAA,CACnB,CACH,EAEC,WAAE,QAAQ,CAAA,CAAA,EAGdH,EAAU,cACT9C,EAACO,EAAA,CACC,QAAQ,YACR,QAAS,SAAY,CACnB,MAAMM,EAAM,CACV,OAAQiC,EAAU,YAAA,CACnB,CACH,EACA,gBAAc,SAEb,WAAE,QAAQ,CAAA,CAAA,CACb,CAAA,EA/BE,QAAA,CAiCN,CACF,CAAA,CACF,CACF,CAAA,EA3CiBG,EAAK,WAAW,EA4CnC,CACD,CAAA,CAAA,CAAA,CACH,CAAA,EAtGaH,EAAU,IAuGzB,CACD,CAAA,GA/GaJ,CAgHlB,CACD,EACH,CAEJ"}